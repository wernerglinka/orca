/*global require, console, module, plugin*/

const fs = require('fs');
const http = require('http');

function plugin(imageURL, targetDir) {
    'use strict';

    let relImageSource = imageURL.split("/");
    let imageName = relImageSource[relImageSource.length - 1];
    let file = fs.createWriteStream("./dev/sources" + targetDir + imageName);
    let downloadDone = false;

    http.get(imageURL, function (response) {
        response.pipe(file);
    });

    file.on('finish', function () {
        console.log("finished downloading " + imageName);
        downloadDone = true;
    });

    while (true) {
        if (downloadDone) {
            return imageName;
        }
    }

    
}

module.exports = plugin;